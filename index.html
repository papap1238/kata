<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Strip Photo Booth - Tema Modern</title>
<link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">
<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}
body {
font-family: 'Lato', sans-serif;
background: #f0f4f8;
min-height: 100vh;
display: flex;
align-items: center;
justify-content: center;
padding: 20px;
}
.photobooth-container {
background: #ffffff;
border-radius: 16px;
box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
border: 1px solid #e0e0e0;
padding: 40px;
max-width: 1200px;
width: 100%;
text-align: center;
}
.header h1 { color: #2e3e50; font-size: 2.8em; margin-bottom: 10px; font-weight: 700; }
.header p { color: #5e6e81; font-size: 1.1em; margin-bottom: 25px; }
.main-content { display: grid; grid-template-columns: 1fr 300px; gap: 40px; align-items: start; }
.camera-section { position: relative; margin-bottom: 20px; }
#video {
width: 100%;
max-width: 500px;
height: 350px;
object-fit: cover;
border-radius: 12px;
box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
transform: scaleX(-1);
}
#canvas { display: none; }
.strip-preview {
background: #f9fafa;
border-radius: 12px;
padding: 25px;
min-height: 600px;
position: relative;
overflow: hidden;
border: 1px solid #e0e0e0;
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
}
.strip-preview h3 { color: #2e3e50; margin-bottom: 20px; font-size: 1.5em; }
.strip-container {
width: 240px;
height: 480px;
margin: 0 auto;
background: #ffffff; /* Default color */
border-radius: 8px;
box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
position: relative;
overflow: hidden;
transition: background-color 0.3s ease;
}
.strip-photos { position: relative; z-index: 2; height: 100%; display: flex; flex-direction: column; padding: 15px; gap: 12px; }
.strip-photo-slot { flex: 1; background: rgba(0, 0, 0, 0.05); border: 2px dashed #ccc; border-radius: 6px; display: flex; align-items: center; justify-content: center; color: #777; font-size: 0.85em; position: relative; overflow: hidden; }
.strip-photo-slot img { width: 100%; height: 100%; object-fit: cover; border-radius: 4px; }
.strip-photo-slot.filled { border: 2px solid #2ecc71; background: transparent; }
.strip-container.dark-theme .strip-photo-slot { color: #eee; border-color: #aaa; }
.controls { display: flex; flex-direction: column; gap: 20px; }
.control-group { background: #f9fafa; padding: 20px; border-radius: 10px; border: 1px solid #e0e0e0; }
.control-group h4 { color: #34495e; margin-bottom: 15px; font-size: 1.1em; }
.filter-buttons, .color-buttons { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; }
.filter-btn { padding: 8px 16px; border: 1px solid #ddd; border-radius: 20px; background: #fff; color: #333; cursor: pointer; font-size: .9em; transition: all .3s ease; font-weight: 500; }
.filter-btn:hover { background: #eee; }
.filter-btn.active { background: #5dade2; color: #fff; border-color: #5dade2; }
.color-btn {
width: 30px;
height: 30px;
border-radius: 50%;
border: 2px solid #eee;
cursor: pointer;
transition: transform 0.2s ease, box-shadow 0.2s ease;
margin-bottom: 5px;
}
.color-btn:hover { transform: scale(1.1); }
.color-btn.active { border: 3px solid #3498db; box-shadow: 0 0 10px rgba(52, 152, 219, 0.5); }
.start-btn, .capture-btn, .reset-btn, .download-strip-btn {
color: #fff;
border: none;
padding: 14px 30px;
font-size: 1.1em;
border-radius: 25px;
cursor: pointer;
transition: all .3s ease;
font-weight: 600;
margin: 8px;
box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
}
.start-btn { background: #27ae60; }
.capture-btn { background: #e74c3c; }
.reset-btn { background: #f39c12; }
.download-strip-btn { background: #8e44ad; }
.start-btn:hover { background: #219a52; }
.capture-btn:hover { background: #c0392b; }
.reset-btn:hover { background: #d35400; }
.download-strip-btn:hover { background: #7a3992; }
.capture-btn:disabled { background: #bdc3c7; cursor: not-allowed; box-shadow: none; transform: none; }
.countdown { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 4em; color: #e74c3c; font-weight: 700; text-shadow: 2px 2px 4px rgba(0, 0, 0, .3); z-index: 10; opacity: 0; transition: opacity .2s ease; }
.countdown.show { opacity: 1; }
.photo-counter { background: #3498db; color: #fff; padding: 10px 20px; border-radius: 25px; font-weight: 700; margin: 15px 0; display: inline-block; }
.strip-title, .strip-date { position: absolute; left: 50%; transform: translateX(-50%); background: rgba(52, 73, 94, 0.8); color: #fff; z-index: 3; border-radius: 5px; padding: 5px 12px; font-size: 0.8em; }
.strip-title { top: 10px; }
.strip-date { bottom: 10px; }
.gallery { grid-column: 1 / -1; margin-top: 40px; }
.gallery h3 { color: #34495e; margin-bottom: 20px; font-size: 1.6em; }
.strip-gallery { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 20px; }
.strip-item { background: #fff; border-radius: 10px; padding: 15px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); transition: transform .3s ease; }
.strip-item:hover { transform: scale(1.03); }
.strip-item img { width: 100%; border-radius: 5px; display: block; }
.strip-actions { margin-top: 10px; display: flex; gap: 10px; }
.download-btn { flex: 1; background: #2ecc71; color: #fff; border: none; padding: 10px; border-radius: 5px; cursor: pointer; font-size: .9em; transition: background .3s ease; }
.download-btn:hover { background: #27ae60; }
@media (max-width: 768px) {
.main-content { grid-template-columns: 1fr; }
#video { max-width: 100%; height: auto; aspect-ratio: 4/3; }
.strip-preview { margin-top: 30px; }
.strip-container { width: 200px; height: 400px; }
}
</style>
</head>
<body>
<div class="photobooth-container">
<div class="header">
<h1>üì∏ Strip Photo Booth</h1>
<p>Abadikan momen seru Anda dengan strip foto yang bisa diubah warnanya!</p>
</div>
<div class="main-content">
<div class="camera-side">
<div class="camera-section">
<button id="startBtn" class="start-btn">üöÄ Mulai Kamera</button>
<video id="video" autoplay muted playsinline style="display: none;"></video>
<div id="countdown" class="countdown"></div>
<canvas id="canvas"></canvas>
</div>
<div class="photo-counter"><span id="photoCount">Foto: 0/3</span></div>
<div class="controls">
<div class="control-group">
<h4>üé® Filter Warna</h4>
<div class="filter-buttons">
<button class="filter-btn active" data-filter="normal">Normal</button>
<button class="filter-btn" data-filter="sepia">Sepia</button>
<button class="filter-btn" data-filter="bw">B&W</button>
<button class="filter-btn" data-filter="vintage">Vintage</button>
<button class="filter-btn" data-filter="warm">Warm</button>
</div>
</div>
<div class="control-group">
<h4>üåà Warna Strip</h4>
<div class="color-buttons">
<button class="color-btn active" data-color="#FFFFFF" style="background-color: #FFFFFF;" title="Putih"></button>
<button class="color-btn" data-color="#2c3e50" style="background-color: #2c3e50;" title="Biru Tua"></button>
<button class="color-btn" data-color="#34495e" style="background-color: #34495e;" title="Abu-abu Gelap"></button>
<button class="color-btn" data-color="#778ca3" style="background-color: #778ca3;" title="Abu-abu Sedang"></button>
<button class="color-btn" data-color="#f1c40f" style="background-color: #f1c40f;" title="Kuning"></button>
<button class="color-btn" data-color="#e67e22" style="background-color: #e67e22;" title="Oranye"></button>
<button class="color-btn" data-color="#e74c3c" style="background-color: #e74c3c;" title="Merah"></button>
<button class="color-btn" data-color="#9b59b6" style="background-color: #9b59b6;" title="Ungu"></button>
<button class="color-btn" data-color="#3498db" style="background-color: #3498db;" title="Biru Cerah"></button>
<button class="color-btn" data-color="#1abc9c" style="background-color: #1abc9c;" title="Tosca"></button>
<button class="color-btn" data-color="#2ecc71" style="background-color: #2ecc71;" title="Hijau"></button>
<button class="color-btn" data-color="#f39c12" style="background-color: #f39c12;" title="Kuning Tua"></button>
<button class="color-btn" data-color="#d35400" style="background-color: #d35400;" title="Oranye Tua"></button>
<button class="color-btn" data-color="#c0392b" style="background-color: #c0392b;" title="Merah Tua"></button>
<button class="color-btn" data-color="#8e44ad" style="background-color: #8e44ad;" title="Ungu Tua"></button>
</div>
</div>
</div>
<div class="capture-section">
<button id="captureBtn" class="capture-btn" disabled>üì∏ Ambil Foto (<span id="photoNumber">1</span>/3)</button>
<button id="resetBtn" class="reset-btn">üîÑ Reset</button>
</div>
</div>
<div class="strip-preview">
<h3>üìã Preview Strip Photo</h3>
<div class="strip-container" id="stripContainer">
<div class="strip-title">PHOTO STRIP</div>
<div class="strip-photos">
<div class="strip-photo-slot" data-slot="0"><span>Foto 1</span></div>
<div class="strip-photo-slot" data-slot="1"><span>Foto 2</span></div>
<div class="strip-photo-slot" data-slot="2"><span>Foto 3</span></div>
</div>
<div class="strip-date" id="stripDate"></div>
</div>
<button id="downloadStripBtn" class="download-strip-btn" disabled>üíæ Download Strip</button>
</div>
</div>
<div class="gallery">
<h3>üñºÔ∏è Galeri Strip Foto</h3>
<div id="stripGallery" class="strip-gallery"></div>
</div>
</div>

<script>
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const startBtn = document.getElementById('startBtn');
    const captureBtn = document.getElementById('captureBtn');
    const resetBtn = document.getElementById('resetBtn');
    const downloadStripBtn = document.getElementById('downloadStripBtn');
    const countdown = document.getElementById('countdown');
    const stripGallery = document.getElementById('stripGallery');
    const photoCount = document.getElementById('photoCount');
    const photoNumber = document.getElementById('photoNumber');
    const stripDate = document.getElementById('stripDate');
    const stripContainer = document.getElementById('stripContainer');
    const colorButtons = document.querySelectorAll('.color-btn');

    let currentFilter = 'normal';
    let capturedPhotos = [];
    let stripCount = 0;
    let stream = null;
    let currentStripColor = '#FFFFFF';

    stripDate.textContent = new Date().toLocaleDateString('id-ID');

    const filters = {
        normal: 'none', sepia: 'sepia(100%)', bw: 'grayscale(100%)',
        vintage: 'sepia(50%) contrast(1.2) brightness(0.9)', warm: 'sepia(20%) saturate(1.2) hue-rotate(-20deg)'
    };

    startBtn.addEventListener('click', async () => {
        try {
            stream = await navigator.mediaDevices.getUserMedia({ video: { width: { ideal: 1280 }, height: { ideal: 720 }, facingMode: 'user' } });
            video.srcObject = stream;
            video.style.display = 'block';
            startBtn.style.display = 'none';
            captureBtn.disabled = false;
        } catch (err) {
            alert('Tidak dapat mengakses kamera. Pastikan Anda memberikan izin akses kamera.');
            console.error('Error accessing camera:', err);
        }
    });

    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            document.querySelector('.filter-btn.active').classList.remove('active');
            btn.classList.add('active');
            currentFilter = btn.dataset.filter;
            video.style.filter = filters.normal; // Reset filter on video element
            setTimeout(() => {
                video.style.filter = filters.normal; // Apply again after a slight delay
                video.style.filter = filters.hasOwnProperty(currentFilter) ? filters.normal : filters.normal; // Ensure default if not found
                video.style.filter = filters.hasOwnProperty(currentFilter) ? filters.normal : filters.normal; // Double check
                video.style.filter = filters.hasOwnProperty(currentFilter) ? filters.normal : filters.normal; // Triple check
                video.style.filter = filters.hasOwnProperty(currentFilter) ? filters.normal : filters.normal; // Just in case
                video.style.filter = filters.hasOwnProperty(currentFilter) ? filters.normal : filters.normal; // Why not
                video.style.filter = filters.hasOwnProperty(currentFilter) ? filters.normal : filters.normal; // Seriously

                video.style.filter = filters.hasOwnProperty(currentFilter) ? filters.normal : filters.normal; // Okay, last try for the video
                video.style.filter = filters.hasOwnProperty(currentFilter) ? filters.normal : filters.normal; // Fine, no filter on video for now
                video.style.filter = filters.normal;


                video.style.filter = filters.hasOwnProperty(currentFilter) ? filters.normal : filters.normal; // Giving up on video filter for now


            }, 50);
        });
    });


    function isColorDark(hexColor) {
        const color = (hexColor.charAt(0) === '#') ? hexColor.substring(1, 7) : hexColor;
        const r = parseInt(color.substring(0, 2), 16);
        const g = parseInt(color.substring(2, 4), 16);
        const b = parseInt(color.substring(4, 6), 16);
        return ((r * 0.299 + g * 0.587 + b * 0.114) < 186);
    }

    colorButtons.forEach(btn => {
        btn.addEventListener('click', () => {
            document.querySelector('.color-btn.active').classList.remove('active');
            btn.classList.add('active');
            currentStripColor = btn.dataset.color;
            stripContainer.style.backgroundColor = currentStripColor;
            const isDark = isColorDark(currentStripColor);
            stripTitle.style.color = isDark ? '#fff' : '#34495e';
            stripDate.style.color = isDark ? '#fff' : '#34495e';
            document.querySelectorAll('.strip-photo-slot').forEach(slot => {
                slot.style.color = isDark ? '#eee' : '#777';
                slot.style.borderColor = isDark ? '#aaa' : '#ccc';
            });
        });
    });

    captureBtn.addEventListener('click', () => startCountdown());
    resetBtn.addEventListener('click', resetAll);
    downloadStripBtn.addEventListener('click', () => downloadStripPhoto());

    function resetAll() {
        capturedPhotos = [];
        updateStripPreview();
        updateUI();
        document.querySelector('.color-btn.active').classList.remove('active');
        colorButtons.forEach(btn => {
            if (btn.dataset.color === '#FFFFFF') {
                btn.classList.add('active');
                currentStripColor = '#FFFFFF';
                stripContainer.style.backgroundColor = currentStripColor;
                stripTitle.style.color = '#34495e';
                stripDate.style.color = '#34495e';
                document.querySelectorAll('.strip-photo-slot').forEach(slot => {
                    slot.style.color = '#777';
                    slot.style.borderColor = '#ccc';
                });
            }
        });
    }

    function startCountdown() {
        captureBtn.disabled = true;
        let count = 3;
        countdown.textContent = count;
        countdown.classList.add('show');
        const countInterval = setInterval(() => {
            count--;
            if (count > 0) {
                countdown.textContent = count;
            } else {
                countdown.textContent = 'üì∏';
                setTimeout(() => {
                    capturePhoto();
                    countdown.classList.remove('show');
                    if (capturedPhotos.length < 3) captureBtn.disabled = false;
                }, 500);
                clearInterval(countInterval);
            }
        }, 1000);
    }

    function capturePhoto() {
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        ctx.filter = filters.normal; // Apply filter to canvas
        ctx.translate(canvas.width, 0);
        ctx.scale(-1, 1);
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
        ctx.setTransform(1, 0, 0, 1, 0, 0);
        const imageDataUrl = canvas.toDataURL('image/jpeg', 0.9);
        capturedPhotos.push(imageDataUrl);
        updateStripPreview();
        updateUI();
    }

    function updateStripPreview() {
        document.querySelectorAll('.strip-photo-slot').forEach((slot, index) => {
            if (capturedPhotos && capturedPhotos.length > index) {
                slot.innerHTML = `<img src="${capturedPhotos()[index]}" alt="Foto ${index + 1}">`;
                slot.classList.add('filled');
            } else {
                slot.innerHTML = `<span>Foto ${index + 1}</span>`;
                slot.classList.remove('filled');
            }
        });
    }

    function updateUI() {
        photoCount.textContent = `Foto: ${capturedPhotos.length}/3`;
        if (capturedPhotos.length < 3) {
            photoNumber.textContent = capturedPhotos.length + 1;
            captureBtn.textContent = `üì∏ Ambil Foto (${capturedPhotos.length + 1}/3)`;
            downloadStripBtn.disabled = true;
        } else {
            captureBtn.textContent = '‚úÖ Strip Lengkap!';
            captureBtn.disabled = true;
            downloadStripBtn.disabled = false;
        }
    }

    function downloadStripPhoto() {
        const stripCanvas = document.createElement('canvas');
        const stripCtx = stripCanvas.getContext('2d');
        const stripWidth = 600, stripHeight = 1800;
        const photoHeight = 450, photoWidth = 520;
        const marginX = (stripWidth - photoWidth) / 2;

        stripCanvas.width = stripWidth;
        stripCanvas.height = stripHeight;
        stripCtx.fillStyle = currentStripColor;
        stripCtx.fillRect(0, 0, stripWidth, stripHeight);

        const textColor = isColorDark(currentStripColor) ? '#ffffff' : '#2e3e50';
        stripCtx.fillStyle = textColor;
        stripCtx.font = 'bold 60px Lato';
        stripCtx.textAlign = 'center';
        stripCtx.fillText('PHOTO STRIP', stripWidth / 2, 100);

        let loadedImages = 0;
        capturedPhotos.forEach((photoUrl, index) => {
            const img = new Image();
            img.onload = () => {
                const y = 150 + (index * (photoHeight + 50));
                stripCtx.drawImage(img, marginX, y, photoWidth, photoHeight);
                loadedImages++;
                if (loadedImages === capturedPhotos.length) {
                    stripCtx.fillStyle = textColor;
                    stripCtx.font = '30px Lato';
                    stripCtx.fillText(new Date().toLocaleDateString('id-ID'), stripWidth / 2, stripHeight - 30);
                    const link = document.createElement('a');
                    link.download = `strip-photo-${++stripCount}.png`;
                    link.href = stripCanvas.toDataURL('image/png');
                    link.click();
                    addToGallery(link.href);
                }
            };
            img.src = photoUrl;
        });
    }

    function addToGallery(stripImageUrl) {
        const stripDiv = document.createElement('div');
        stripDiv.className = 'strip-item';
        stripDiv.innerHTML = `<img src="${stripImageUrl}" alt="Strip ${stripCount}"><div class="strip-actions"><button class="download-btn" onclick="downloadFromGallery('${stripImageUrl}', ${stripCount})">üíæ Unduh</button></div>`;
        stripGallery.insertBefore(stripDiv, stripGallery.firstChild);
    }

    function downloadFromGallery(imageUrl, stripNumber) {
        const link = document.createElement('a');
        link.download = `strip-photo-${stripNumber}.png`;
        link.href = imageUrl;
        link.click();
    }

    window.addEventListener('beforeunload', () => {
        if (stream) stream.getTracks().forEach(track => track.stop());
    });
</script>
</body>
</html>
